<!DOCTYPE html><html><head><title>Neighborhood Map</title><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="lib/bootstrap/css/bootstrap.min.css"><style>.nopadding{padding:0!important;margin:0!important}body{width:100%;height:100%}.my-site{width:80%;margin:0 auto}h1{display:inline}.heading{margin:3% auto}ul{list-style-type:none;margin:0;padding:0}.menu-icon{display:none}.input-group-btn select,.input-group-btn label{border-color:#ccc}.view-list{overflow:scroll;height:500px}#mapDiv{width:100%;height:500px;margin:0 0 15%}.info-window{width:250px}.info-window p{margin:3px}@media screen and (max-width:992px){h1{font-size:2em;margin:auto auto auto 20px}.info-window{width:150px}.menu-icon{display:inline;width:30px;height:30px}.mainDiv{position:absolute;width:80%;height:100%}.view-list{display:none;position:absolute;top:0;left:0;z-index:10}}@media screen and (max-width:660px){h1{font-size:1.5em}}</style><link rel="stylesheet" href="https://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.min.css"><script src="lib/jQuery/jQuery.js"></script><script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script><script src="lib/bootstrap/js/bootstrap.min.js"></script><script src="lib/knockout/knockout-3.3.0.js"></script><script>function googleError() {
      alert("Google map fail to load!");
    }</script><script async defer="defer" src="http://maps.googleapis.com/maps/api/js?callback=initialize" onerror="googleError()"></script></head><body><div class="container my-site"><section class="heading text-center"><img class="menu-icon" src="img/menu.png" alt="Menu icon not found!"><h1>Restaurants Near Duke University</h1></section><section class="row"><div class="col-md-12 nopadding"><div class="input-group nopadding"><span class="input-group-btn" id="basic-addon1"><label class="glyphicon glyphicon-search btn"></label><select class="btn" data-bind="options: choiceList, optionsText: 'name', optionsValue: 'id', value: selectedChoice, event: {change: selectionChanged}"></select></span> <input type="text" autofocus class="form-control input-search" data-bind="textInput: query, event: {keyup: search}" autocomplete="on" placeholder="Find a Location Here" aria-describedby="basic-addon1"></div></div></section><section class="row mainDiv"><div class="col-md-3 nopadding view-list"><div class="list-group"><a href="#" class="list-group-item disabled">Key Locations</a><div data-bind="foreach: locList"><a href="#" class="list-group-item" data-bind="text: name, click: $parent.setLoc"></a></div></div></div><div class="col-md-9 nopadding"><div id="mapDiv"></div></div></section></div><script>function initialize(){var n=new google.maps.Geocoder;bounds=new google.maps.LatLngBounds;var e={center:new google.maps.LatLng(35.5,-78),zoom:8};map=new google.maps.Map(document.getElementById("mapDiv"),e);for(var o=0;o<iniLocs.length;o++){var i=iniLocs[o].address;n.geocode({address:i},addMarker(o))}}function addMarker(n){var e=function(e,o){o==google.maps.GeocoderStatus.OK?(marker=new google.maps.Marker({position:e[0].geometry.location,map:map,icon:redPin,animation:google.maps.Animation.DROP}),markers.push(marker),infoWindow=new google.maps.InfoWindow,infoWindowContent(n,function(n){infoWindow.setContent(n),infoWindows.push(infoWindow)}),autoCenter(e[0].geometry.location),google.maps.event.addListener(marker,"click",function(){function e(){o.setAnimation(null),o.setIcon(redPin)}var o=this;infoWindowContent(n,function(n){infoWindow.setContent(n),infoWindow.open(map,o)}),toggleBounce(o),setTimeout(e,1400)})):alert("Location fail to geocode: "+o)};return e}function infoWindowContent(n,e){foursquareUrl=foursquareBaseUrl+iniLocs[n].name+"&ll="+iniLocs[n].lan+","+iniLocs[n].lng,$.getJSON(foursquareUrl).done(function(n){var o=n.response.venues[0],i=o.name,a=o.location.formattedAddress,s=void 0===o.contact.formattedPhone?"None":o.contact.formattedPhone;windowContent='<div class="info-window"><p><strong>Name: </strong>'+i+"</p><p><strong>Address: </strong>  "+a+"</p><p><strong>Phone: </strong>"+s+"</p></div>",e(windowContent)}).fail(function(n,e,o){alert("Fail to connect to Foursquare: "+e+" "+n.status+" "+o)})}function toggleBounce(n){null!==n.getAnimation()?n.setAnimation(null):(n.setAnimation(google.maps.Animation.BOUNCE),n.setIcon(greenPin))}function autoCenter(n){++locationNum,bounds.extend(n),locationNum==iniLocs.length&&map.fitBounds(bounds)}for(var nameArr=[],addrArr=[],map,locationNum=0,bounds,infoWindow,infoWindows=[],marker,markers=[],windowContent,redPin="http://maps.google.com/mapfiles/ms/icons/red-dot.png",greenPin="http://maps.google.com/mapfiles/ms/icons/green-dot.png",foursquareUrl,CLIENT_ID="KIT4KDDY2ITLGLYX0MTQJT5WPODSQDI0H2WGJ004EQAJ40YL",CLIENT_SECRET="MO4EL3JXXJGFVW13TRRILPDDYD3LVIGDCUETIDLLTWNLNXLN",foursquareBaseUrl="https://api.foursquare.com/v2/venues/search?client_id="+CLIENT_ID+"&client_secret="+CLIENT_SECRET+"&v=20140806&query=",iniLocs=[{name:"Shanghai Chinese Restaurant",address:"3433 Hillsborough Rd, Durham, NC 27705",lan:"36.018610",lng:"-78.947815"},{name:"Ruby Tuesday",address:"Northgate Mall, 1058 W Club Blvd, Durham, NC 27701",lan:"36.020117",lng:"-78.910002"},{name:"Nasher Museum Cafe",address:"2001 Campus Dr, Durham, NC 27701",lan:"35.999047",lng:"-78.929032"},{name:"McDonald's",address:"102 W Morgan St, Durham, NC 27701",lan:"35.998521",lng:"-78.899509"},{name:"Wendy's",address:"3527 Hillsborough Rd, Durham, NC 27705",lan:"36.021190",lng:"-78.951580"},{name:"Grace's Cafe",address:"Trent Hall 040A, 331 Trent Dr, Durham, NC 27706",lan:"36.004361",lng:"-78.934411"},{name:"The Loop Pizza Grill",address:"West Campus Union Bldg, Durham, NC 27708",lan:"36.007570",lng:"-78.913984"},{name:"Sushi Love",address:"2812 Erwin Rd #204, Durham, NC 27705",lan:"36.006978",lng:"-78.946876"},{name:"Palace International Restaurant",address:"1104 Broad St, Durham, NC 27705",lan:"36.015767",lng:"-78.918965"},{name:"Firehouse Subs",address:"2608 Erwin Rd Ste 128, Durham, NC 27705",lan:"36.009268",lng:"-78.944814"},{name:"Mesa Latin Kitchen",address:"2701 Hillsborough Rd, Durham, NC 27705",lan:"36.011610",lng:"-78.930700"}],j=0;j<iniLocs.length;j++)nameArr.push(iniLocs[j].name),addrArr.push(iniLocs[j].address);var inputDiv=$(".input-search"),Loc=function(n){this.name=ko.observable(n.name)},iniChoices=[{id:"name",name:"Search By Name"},{id:"address",name:"Search By Address"}],Choice=function(n){this.id=ko.observable(n.id),this.name=ko.observable(n.name)},ViewModel=function(){function n(n){i.locList.removeAll();for(var e=0;e<iniLocs.length;e++)infoWindows[e].close(),markers[e].setVisible(!1),iniLocs[e][i.selectedChoice()].toLowerCase().indexOf(n.toLowerCase())>=0&&(i.locList.push(new Loc(iniLocs[e])),markers[e].setVisible(!0))}function e(){"name"==i.selectedChoice()?o(nameArr):o(addrArr)}function o(e){var o;inputDiv.autocomplete({source:e,select:function(e,i){o=i.item.value,n(o)}})}var i=this;i.selectedChoice=ko.observable(),i.choiceList=ko.observableArray([]),iniChoices.forEach(function(n){i.choiceList.push(new Choice(n))}),i.locList=ko.observableArray([]),iniLocs.forEach(function(n){i.locList.push(new Loc(n))}),this.setLoc=function(n){for(var e,o=0;o<iniLocs.length;o++)iniLocs[o].name==n.name()&&(e=markers[o],toggleBounce(e),infoWindowContent(o,function(n){infoWindow.setContent(n),infoWindow.open(map,e)}),setTimeout(function(){e.setAnimation(null),e.setIcon(redPin)},1400))},i.query=ko.observable(""),i.search=function(){n(i.query()),e()},i.selectionChanged=function(){n(i.query()),e()}};ko.applyBindings(new ViewModel);var menu=document.querySelector(".menu-icon");menu.addEventListener("click",function(){$(".view-list").toggle("slide")});</script></body></html>