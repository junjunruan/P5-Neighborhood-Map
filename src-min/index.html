<!DOCTYPE html><html><head><title>Neighborhood Map</title><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="lib/bootstrap/css/bootstrap.min.css"><style>.nopadding{padding:0!important;margin:0!important}body{width:100%;height:100%}.my-site{width:80%;margin:0 auto}h1{margin:3% auto}ul{list-style-type:none;margin:0;padding:0}.input-group-btn select,.input-group-btn label{border-color:#ccc}#mapDiv{width:100%;height:500px;margin:0 0 15%}.info-window{width:250px}.info-window p{margin:3px}@media screen and (max-width:900px){h1{font-size:2em}}@media screen and (max-width:600px){h1{font-size:1.7em}.info-window{width:150px}}</style><script src="lib/jQuery/jQuery.js"></script><script src="lib/bootstrap/js/bootstrap.min.js"></script><script src="lib/knockout/knockout-3.3.0.js"></script><script>function loadMap() {
      google.maps.event.addDomListener(window, 'load', initialize);
    }</script><script>function googleError() {
      alert("Google map fail to load!");
    }</script><script async defer="defer" src="http://maps.googleapis.com/maps/api/js?callback=loadMap" onerror="googleError()"></script></head><body><div class="container my-site"><h1 class="text-center">Restaurants Near Duke University</h1><section class="row"><div class="col-md-12 nopadding"><div class="input-group nopadding"><span class="input-group-btn" id="basic-addon1"><label class="glyphicon glyphicon-search btn"></label><select class="btn" data-bind="options: choiceList, optionsText: 'name', optionsValue: 'id', value: selectedChoice, event: {change: selectionChanged}"></select></span> <input type="text" autofocus class="form-control" data-bind="textInput: query, event: {keyup: search}" autocomplete="off" placeholder="Find a Location Here" aria-describedby="basic-addon1"></div></div></section><section class="row"><div class="col-md-3 nopadding"><div class="list-group"><a href="#" class="list-group-item disabled">Key Locations</a><div data-bind="foreach: locList"><a href="#" class="list-group-item" data-bind="text: name, click: $parent.setLoc"></a></div></div></div><div class="col-md-9 nopadding"><div id="mapDiv"></div></div></section></div><script>function initialize(){var e=new google.maps.Geocoder;bounds=new google.maps.LatLngBounds;var n={center:new google.maps.LatLng(35.5,-78),zoom:8};for(map=new google.maps.Map(document.getElementById("mapDiv"),n),i=0;i<iniLocs.length;i++){var o=iniLocs[i].address;e.geocode({address:o},addMarker(i))}}function addMarker(e){var n=function(n,o){o==google.maps.GeocoderStatus.OK?(marker=new google.maps.Marker({position:n[0].geometry.location,map:map,icon:redPin,animation:google.maps.Animation.DROP}),markers.push(marker),infoWindow=new google.maps.InfoWindow,infoWindowContent(e,function(e){infoWindow.setContent(e),infoWindows.push(infoWindow)}),autoCenter(n[0].geometry.location),google.maps.event.addListener(marker,"click",function(){function n(){o.setAnimation(null),o.setIcon(redPin)}var o=this;foursquareRequestTimeout=setTimeout(function(){alert("failed to connect to Foursquare API")},8e3),infoWindowContent(e,function(e){infoWindow.setContent(e),infoWindow.open(map,o)}),toggleBounce(o),setTimeout(n,1400)})):alert("Location fail to geocode: "+o)};return n}function infoWindowContent(e,n){foursquareUrl=foursquareBaseUrl+iniLocs[e].name+"&ll="+iniLocs[e].lan+","+iniLocs[e].lng,$.getJSON(foursquareUrl,function(e){var o=e.response.venues[0];curMarkerName=o.name,curMarkerAddress=o.location.formattedAddress,curMarkerPhone=void 0===o.contact.formattedPhone?"None":o.contact.formattedPhone,windowContent='<div class="info-window"><p><strong>Name: </strong>'+curMarkerName+"</p><p><strong>Address: </strong>  "+curMarkerAddress+"</p><p><strong>Phone: </strong>"+curMarkerPhone+"</p></div>",n(windowContent),clearTimeout(foursquareRequestTimeout)})}function toggleBounce(e){null!==e.getAnimation()?e.setAnimation(null):(e.setAnimation(google.maps.Animation.BOUNCE),e.setIcon(greenPin))}function autoCenter(e){++locationNum,bounds.extend(e),locationNum==iniLocs.length&&map.fitBounds(bounds)}var map,locationNum=0,bounds,infoWindow,infoWindows=[],marker,markers=[],windowContent,redPin="http://maps.google.com/mapfiles/ms/icons/red-dot.png",greenPin="http://maps.google.com/mapfiles/ms/icons/green-dot.png",stopBounce,foursquareUrl,foursquareRequestTimeout,CLIENT_ID="KIT4KDDY2ITLGLYX0MTQJT5WPODSQDI0H2WGJ004EQAJ40YL",CLIENT_SECRET="MO4EL3JXXJGFVW13TRRILPDDYD3LVIGDCUETIDLLTWNLNXLN",foursquareBaseUrl="https://api.foursquare.com/v2/venues/search?client_id="+CLIENT_ID+"&client_secret="+CLIENT_SECRET+"&v=20140806&query=",iniLocs=[{name:"Shanghai Chinese Restaurant",address:"3433 Hillsborough Rd, Durham, NC 27705",lan:"36.018610",lng:"-78.947815"},{name:"Ruby Tuesday",address:"Northgate Mall, 1058 W Club Blvd, Durham, NC 27701",lan:"36.020117",lng:"-78.910002"},{name:"Nasher Museum Cafe",address:"2001 Campus Dr, Durham, NC 27701",lan:"35.999047",lng:"-78.929032"},{name:"McDonald's",address:"102 W Morgan St, Durham, NC 27701",lan:"35.998521",lng:"-78.899509"},{name:"Wendy's",address:"3527 Hillsborough Rd, Durham, NC 27705",lan:"36.021190",lng:"-78.951580"},{name:"Grace's Cafe",address:"Trent Hall 040A, 331 Trent Dr, Durham, NC 27706",lan:"36.004361",lng:"-78.934411"},{name:"The Loop Pizza Grill",address:"West Campus Union Bldg, Durham, NC 27708",lan:"36.007570",lng:"-78.913984"},{name:"Sushi Love",address:"2812 Erwin Rd #204, Durham, NC 27705",lan:"36.006978",lng:"-78.946876"},{name:"Palace International Restaurant",address:"1104 Broad St, Durham, NC 27705",lan:"36.015767",lng:"-78.918965"},{name:"Firehouse Subs",address:"2608 Erwin Rd Ste 128, Durham, NC 27705",lan:"36.009268",lng:"-78.944814"},{name:"Mesa Latin Kitchen",address:"2701 Hillsborough Rd, Durham, NC 27705",lan:"36.011610",lng:"-78.930700"}],Loc=function(e){this.name=ko.observable(e.name)},iniChoices=[{id:"name",name:"Search Name"},{id:"address",name:"Search Location"}],Choice=function(e){this.id=ko.observable(e.id),this.name=ko.observable(e.name)},ViewModel=function(){function e(){n.locList.removeAll();for(var e=0;e<iniLocs.length;e++)infoWindows[e].close(),markers[e].setVisible(!1),iniLocs[e][n.selectedChoice()].toLowerCase().indexOf(n.query().toLowerCase())>=0&&(n.locList.push(new Loc(iniLocs[e])),markers[e].setVisible(!0))}var n=this;n.selectedChoice=ko.observable(),n.choiceList=ko.observableArray([]),iniChoices.forEach(function(e){n.choiceList.push(new Choice(e))}),n.locList=ko.observableArray([]),iniLocs.forEach(function(e){n.locList.push(new Loc(e))}),this.setLoc=function(e){for(var n,o=0;o<iniLocs.length;o++)iniLocs[o].name==e.name()&&(n=markers[o],toggleBounce(markers[o]),infoWindowContent(o,function(e){infoWindow.setContent(e),infoWindow.open(map,n)}),setTimeout(function(){n.setAnimation(null),n.setIcon(redPin)},1400))},n.query=ko.observable(""),n.search=function(){e()},n.selectionChanged=function(){e()}};ko.applyBindings(new ViewModel);</script></body></html>